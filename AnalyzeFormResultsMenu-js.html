<script>

    document.getElementById('removeDupBtn').addEventListener("click", removeDup);
    document.getElementById('removeUnAuthBtn').addEventListener("click", removeUnAuth);
    document.getElementById('CalcAvgBtn').addEventListener("click", calcAvg);
    document.getElementById('delAll').addEventListener("click", delAllResponses);
    
    
    setupOpenInstructions('calcAvgHelp', 'AnalyzeFormResultsHelp-Avg', 'Analyze Form Results Help');
    setupOpenInstructions('removeHelp', 'AnalyzeFormResultsHelp', 'Analyze Form Results Help');
    
    setupMessageBox('Base Item Help', 'baseItemHelp','The unique field in the form. email / I.D / phone / ext..\n For your attention, question Numbering start from 0!', 400, 400, '95%', '95%');
    setupMessageBox('Questions Number Help','qNumbersHelp', 'Only scale Items are supported!\n For your attention, question Numbering start from 0!', 400, 400, '95%', '95%');
    
    // Loading message for remove and calc options are inside the function.
    // The reason is it's shows confirmation message before starting
    
    function removeDup(){
        var PrimaryItem = document.getElementById("PrimaryItem").value;
        google.script.run.withFailureHandler(onFailure).withSuccessHandler(showAlert).removeDuplicates(PrimaryItem);
    }
    
    function removeUnAuth() {
        var PrimaryItem = document.getElementById("PrimaryItem").value;
        google.script.run.withFailureHandler(onFailure).withSuccessHandler(showAlert).removeUnAuth(PrimaryItem);
    }
    
    
    function calcAvg() {
        var qNumbers = document.getElementById("qNumbers").value;
        google.script.run.withFailureHandler(onFailure).withSuccessHandler(showAlert).calcResponsesAvg(qNumbers);
        
    }

    function delAllResponses() {
        google.script.run.withFailureHandler(onFailure).withSuccessHandler(showAlert).delAllResponses();
    }

</script>